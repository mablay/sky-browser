import{h as J,i as re,o as O,c as P,K as be,B as U,P as Se,S as Le,U as Ne,L as we,M as ve,N as Ue,O as Y,W as Ce,T as Fe,Q as Be,V as ue,R as Z,X as Ge,Y as De,Z as ie,$ as ke,a0 as Oe,a1 as j,a2 as X,a3 as ze,a4 as Pe,a5 as He,a6 as Ve,a7 as Ye,a8 as je,a9 as oe,aa as Ke,ab as $e,ac as We,ad as qe,ae as Xe,r as Ee,a as k,t as he,b as q,F as Me,C as Je,D as Ze,E as Qe,H as et,_ as Re,af as fe,ag as tt,ah as H,ai as st,aj as nt,ak as Q,al as K,am as rt,G as it,z as ot,k as at,an as ct,ao as lt,A as Ie,J as ut,ap as ht,aq as ft,ar as dt,I as de,w as pt}from"./entry.e6280125.js";import{u as ae,o as pe,_ as gt,a as mt}from"./drop-zone.f6e429d4.js";const xt=["src"],Tt=J({__name:"icon",props:{icon:{},size:{}},setup(a){const e=a,t=re(()=>({width:`${e.size??20}px`,height:`${e.size??20}px`}));return(i,s)=>(O(),P("img",{src:i.icon??"",style:be(U(t))},null,12,xt))}});let $,ee,z,W;function te(a,e=1/0,t=null){ee||(ee=new Se(2,2,1,1)),z||(z=new Le({uniforms:{blitTexture:new Ne(a)},vertexShader:`
            varying vec2 vUv;
            void main(){
                vUv = uv;
                gl_Position = vec4(position.xy * 1.0,0.,.999999);
            }`,fragmentShader:`
            uniform sampler2D blitTexture; 
            varying vec2 vUv;

            void main(){ 
                gl_FragColor = vec4(vUv.xy, 0, 1);
                
                #ifdef IS_SRGB
                gl_FragColor = LinearTosRGB( texture2D( blitTexture, vUv) );
                #else
                gl_FragColor = texture2D( blitTexture, vUv);
                #endif
            }`})),z.uniforms.blitTexture.value=a,z.defines.IS_SRGB=a.colorSpace==we,z.needsUpdate=!0,W||(W=new ve(ee,z),W.frustrumCulled=!1);const i=new Ue,s=new Y;s.add(W),t||(t=$=new Ce({antialias:!1})),t.setSize(Math.min(a.image.width,e),Math.min(a.image.height,e)),t.clear(),t.render(s,i);const n=new Fe(t.domElement);return n.minFilter=a.minFilter,n.magFilter=a.magFilter,n.wrapS=a.wrapS,n.wrapT=a.wrapT,n.name=a.name,$&&($.dispose(),$=null),n}const ge={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class ce{constructor(){this.pluginCallbacks=[],this.register(function(e){return new St(e)}),this.register(function(e){return new Lt(e)}),this.register(function(e){return new Ut(e)}),this.register(function(e){return new Ct(e)}),this.register(function(e){return new Ft(e)}),this.register(function(e){return new Bt(e)}),this.register(function(e){return new Nt(e)}),this.register(function(e){return new vt(e)}),this.register(function(e){return new Gt(e)}),this.register(function(e){return new Dt(e)}),this.register(function(e){return new kt(e)})}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,s){const n=new bt,r=[];for(let o=0,c=this.pluginCallbacks.length;o<c;o++)r.push(this.pluginCallbacks[o](n));n.setPlugins(r),n.write(e,t,s).catch(i)}parseAsync(e,t){const i=this;return new Promise(function(s,n){i.parse(e,s,n,t)})}}const M={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},se="KHR_mesh_quantization",N={};N[Ve]=M.NEAREST;N[Ye]=M.NEAREST_MIPMAP_NEAREST;N[je]=M.NEAREST_MIPMAP_LINEAR;N[oe]=M.LINEAR;N[Ke]=M.LINEAR_MIPMAP_NEAREST;N[$e]=M.LINEAR_MIPMAP_LINEAR;N[We]=M.CLAMP_TO_EDGE;N[qe]=M.REPEAT;N[Xe]=M.MIRRORED_REPEAT;const me={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},_t=new Be,xe=12,yt=1179937895,wt=2,Te=8,Et=1313821514,Mt=5130562;function V(a,e){return a.length===e.length&&a.every(function(t,i){return t===e[i]})}function Rt(a){return new TextEncoder().encode(a).buffer}function It(a){return V(a.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}function At(a,e,t){const i={min:new Array(a.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(a.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let s=e;s<e+t;s++)for(let n=0;n<a.itemSize;n++){let r;a.itemSize>4?r=a.array[s*a.itemSize+n]:(n===0?r=a.getX(s):n===1?r=a.getY(s):n===2?r=a.getZ(s):n===3&&(r=a.getW(s)),a.normalized===!0&&(r=ie.normalize(r,a.array))),i.min[n]=Math.min(i.min[n],r),i.max[n]=Math.max(i.max[n],r)}return i}function Ae(a){return Math.ceil(a/4)*4}function ne(a,e=0){const t=Ae(a.byteLength);if(t!==a.byteLength){const i=new Uint8Array(t);if(i.set(new Uint8Array(a)),e!==0)for(let s=a.byteLength;s<t;s++)i[s]=e;return i.buffer}return a}function _e(){return typeof document>"u"&&typeof OffscreenCanvas<"u"?new OffscreenCanvas(1,1):document.createElement("canvas")}function ye(a,e){if(a.toBlob!==void 0)return new Promise(i=>a.toBlob(i,e));let t;return e==="image/jpeg"?t=.92:e==="image/webp"&&(t=.8),a.convertToBlob({type:e,quality:t})}class bt{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map}}setPlugins(e){this.plugins=e}async write(e,t,i={}){this.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},i),this.options.animations.length>0&&(this.options.trs=!0),this.processInput(e),await Promise.all(this.pending);const s=this,n=s.buffers,r=s.json;i=s.options;const o=s.extensionsUsed,c=s.extensionsRequired,l=new Blob(n,{type:"application/octet-stream"}),m=Object.keys(o),h=Object.keys(c);if(m.length>0&&(r.extensionsUsed=m),h.length>0&&(r.extensionsRequired=h),r.buffers&&r.buffers.length>0&&(r.buffers[0].byteLength=l.size),i.binary===!0){const p=new FileReader;p.readAsArrayBuffer(l),p.onloadend=function(){const f=ne(p.result),d=new DataView(new ArrayBuffer(Te));d.setUint32(0,f.byteLength,!0),d.setUint32(4,Mt,!0);const g=ne(Rt(JSON.stringify(r)),32),A=new DataView(new ArrayBuffer(Te));A.setUint32(0,g.byteLength,!0),A.setUint32(4,Et,!0);const I=new ArrayBuffer(xe),L=new DataView(I);L.setUint32(0,yt,!0),L.setUint32(4,wt,!0);const u=xe+A.byteLength+g.byteLength+d.byteLength+f.byteLength;L.setUint32(8,u,!0);const x=new Blob([I,A,g,d,f],{type:"application/octet-stream"}),y=new FileReader;y.readAsArrayBuffer(x),y.onloadend=function(){t(y.result)}}}else if(r.buffers&&r.buffers.length>0){const p=new FileReader;p.readAsDataURL(l),p.onloadend=function(){const f=p.result;r.buffers[0].uri=f,t(r)}}else t(r)}serializeUserData(e,t){if(Object.keys(e.userData).length===0)return;const i=this.options,s=this.extensionsUsed;try{const n=JSON.parse(JSON.stringify(e.userData));if(i.includeCustomExtensions&&n.gltfExtensions){t.extensions===void 0&&(t.extensions={});for(const r in n.gltfExtensions)t.extensions[r]=n.gltfExtensions[r],s[r]=!0;delete n.gltfExtensions}Object.keys(n).length>0&&(t.extras=n)}catch(n){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+n.message)}}getUID(e,t=!1){if(this.uids.has(e)===!1){const s=new Map;s.set(!0,this.uid++),s.set(!1,this.uid++),this.uids.set(e,s)}return this.uids.get(e).get(t)}isNormalizedNormalAttribute(e){if(this.cache.attributesNormalized.has(e))return!1;const i=new ue;for(let s=0,n=e.count;s<n;s++)if(Math.abs(i.fromBufferAttribute(e,s).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(e){const t=this.cache;if(t.attributesNormalized.has(e))return t.attributesNormalized.get(e);const i=e.clone(),s=new ue;for(let n=0,r=i.count;n<r;n++)s.fromBufferAttribute(i,n),s.x===0&&s.y===0&&s.z===0?s.setX(1):s.normalize(),i.setXYZ(n,s.x,s.y,s.z);return t.attributesNormalized.set(e,i),i}applyTextureTransform(e,t){let i=!1;const s={};(t.offset.x!==0||t.offset.y!==0)&&(s.offset=t.offset.toArray(),i=!0),t.rotation!==0&&(s.rotation=t.rotation,i=!0),(t.repeat.x!==1||t.repeat.y!==1)&&(s.scale=t.repeat.toArray(),i=!0),i&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=s,this.extensionsUsed.KHR_texture_transform=!0)}buildMetalRoughTexture(e,t){if(e===t)return e;function i(f){return f.colorSpace===we?function(g){return g<.04045?g*.0773993808:Math.pow(g*.9478672986+.0521327014,2.4)}:function(g){return g}}console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures."),e instanceof Z&&(e=te(e)),t instanceof Z&&(t=te(t));const s=e?e.image:null,n=t?t.image:null,r=Math.max(s?s.width:0,n?n.width:0),o=Math.max(s?s.height:0,n?n.height:0),c=_e();c.width=r,c.height=o;const l=c.getContext("2d");l.fillStyle="#00ffff",l.fillRect(0,0,r,o);const m=l.getImageData(0,0,r,o);if(s){l.drawImage(s,0,0,r,o);const f=i(e),d=l.getImageData(0,0,r,o).data;for(let g=2;g<d.length;g+=4)m.data[g]=f(d[g]/256)*256}if(n){l.drawImage(n,0,0,r,o);const f=i(t),d=l.getImageData(0,0,r,o).data;for(let g=1;g<d.length;g+=4)m.data[g]=f(d[g]/256)*256}l.putImageData(m,0,0);const p=(e||t).clone();return p.source=new Ge(c),p.colorSpace=De,p.channel=(e||t).channel,e&&t&&e.channel!==t.channel&&console.warn("THREE.GLTFExporter: UV channels for metalnessMap and roughnessMap textures must match."),p}processBuffer(e){const t=this.json,i=this.buffers;return t.buffers||(t.buffers=[{byteLength:0}]),i.push(e),0}processBufferView(e,t,i,s,n){const r=this.json;r.bufferViews||(r.bufferViews=[]);let o;switch(t){case M.BYTE:case M.UNSIGNED_BYTE:o=1;break;case M.SHORT:case M.UNSIGNED_SHORT:o=2;break;default:o=4}const c=Ae(s*e.itemSize*o),l=new DataView(new ArrayBuffer(c));let m=0;for(let f=i;f<i+s;f++)for(let d=0;d<e.itemSize;d++){let g;e.itemSize>4?g=e.array[f*e.itemSize+d]:(d===0?g=e.getX(f):d===1?g=e.getY(f):d===2?g=e.getZ(f):d===3&&(g=e.getW(f)),e.normalized===!0&&(g=ie.normalize(g,e.array))),t===M.FLOAT?l.setFloat32(m,g,!0):t===M.INT?l.setInt32(m,g,!0):t===M.UNSIGNED_INT?l.setUint32(m,g,!0):t===M.SHORT?l.setInt16(m,g,!0):t===M.UNSIGNED_SHORT?l.setUint16(m,g,!0):t===M.BYTE?l.setInt8(m,g):t===M.UNSIGNED_BYTE&&l.setUint8(m,g),m+=o}const h={buffer:this.processBuffer(l.buffer),byteOffset:this.byteOffset,byteLength:c};return n!==void 0&&(h.target=n),n===M.ARRAY_BUFFER&&(h.byteStride=e.itemSize*o),this.byteOffset+=c,r.bufferViews.push(h),{id:r.bufferViews.length-1,byteLength:0}}processBufferViewImage(e){const t=this,i=t.json;return i.bufferViews||(i.bufferViews=[]),new Promise(function(s){const n=new FileReader;n.readAsArrayBuffer(e),n.onloadend=function(){const r=ne(n.result),o={buffer:t.processBuffer(r),byteOffset:t.byteOffset,byteLength:r.byteLength};t.byteOffset+=r.byteLength,s(i.bufferViews.push(o)-1)}})}processAccessor(e,t,i,s){const n=this.json,r={1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"};let o;if(e.array.constructor===Float32Array)o=M.FLOAT;else if(e.array.constructor===Int32Array)o=M.INT;else if(e.array.constructor===Uint32Array)o=M.UNSIGNED_INT;else if(e.array.constructor===Int16Array)o=M.SHORT;else if(e.array.constructor===Uint16Array)o=M.UNSIGNED_SHORT;else if(e.array.constructor===Int8Array)o=M.BYTE;else if(e.array.constructor===Uint8Array)o=M.UNSIGNED_BYTE;else throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type: "+e.array.constructor.name);if(i===void 0&&(i=0),s===void 0&&(s=e.count),s===0)return null;const c=At(e,i,s);let l;t!==void 0&&(l=e===t.index?M.ELEMENT_ARRAY_BUFFER:M.ARRAY_BUFFER);const m=this.processBufferView(e,o,i,s,l),h={bufferView:m.id,byteOffset:m.byteOffset,componentType:o,count:s,max:c.max,min:c.min,type:r[e.itemSize]};return e.normalized===!0&&(h.normalized=!0),n.accessors||(n.accessors=[]),n.accessors.push(h)-1}processImage(e,t,i,s="image/png"){if(e!==null){const n=this,r=n.cache,o=n.json,c=n.options,l=n.pending;r.images.has(e)||r.images.set(e,{});const m=r.images.get(e),h=s+":flipY/"+i.toString();if(m[h]!==void 0)return m[h];o.images||(o.images=[]);const p={mimeType:s},f=_e();f.width=Math.min(e.width,c.maxTextureSize),f.height=Math.min(e.height,c.maxTextureSize);const d=f.getContext("2d");if(i===!0&&(d.translate(0,f.height),d.scale(1,-1)),e.data!==void 0){t!==ke&&console.error("GLTFExporter: Only RGBAFormat is supported.",t),(e.width>c.maxTextureSize||e.height>c.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);const A=new Uint8ClampedArray(e.height*e.width*4);for(let I=0;I<A.length;I+=4)A[I+0]=e.data[I+0],A[I+1]=e.data[I+1],A[I+2]=e.data[I+2],A[I+3]=e.data[I+3];d.putImageData(new ImageData(A,e.width,e.height),0,0)}else d.drawImage(e,0,0,f.width,f.height);c.binary===!0?l.push(ye(f,s).then(A=>n.processBufferViewImage(A)).then(A=>{p.bufferView=A})):f.toDataURL!==void 0?p.uri=f.toDataURL(s):l.push(ye(f,s).then(A=>new FileReader().readAsDataURL(A)).then(A=>{p.uri=A}));const g=o.images.push(p)-1;return m[h]=g,g}else throw new Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(e){const t=this.json;t.samplers||(t.samplers=[]);const i={magFilter:N[e.magFilter],minFilter:N[e.minFilter],wrapS:N[e.wrapS],wrapT:N[e.wrapT]};return t.samplers.push(i)-1}processTexture(e){const i=this.options,s=this.cache,n=this.json;if(s.textures.has(e))return s.textures.get(e);n.textures||(n.textures=[]),e instanceof Z&&(e=te(e,i.maxTextureSize));let r=e.userData.mimeType;r==="image/webp"&&(r="image/png");const o={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY,r)};e.name&&(o.name=e.name),this._invokeAll(function(l){l.writeTexture&&l.writeTexture(e,o)});const c=n.textures.push(o)-1;return s.textures.set(e,c),c}processMaterial(e){const t=this.cache,i=this.json;if(t.materials.has(e))return t.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;i.materials||(i.materials=[]);const s={pbrMetallicRoughness:{}};e.isMeshStandardMaterial!==!0&&e.isMeshBasicMaterial!==!0&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");const n=e.color.toArray().concat([e.opacity]);if(V(n,[1,1,1,1])||(s.pbrMetallicRoughness.baseColorFactor=n),e.isMeshStandardMaterial?(s.pbrMetallicRoughness.metallicFactor=e.metalness,s.pbrMetallicRoughness.roughnessFactor=e.roughness):(s.pbrMetallicRoughness.metallicFactor=.5,s.pbrMetallicRoughness.roughnessFactor=.5),e.metalnessMap||e.roughnessMap){const o=this.buildMetalRoughTexture(e.metalnessMap,e.roughnessMap),c={index:this.processTexture(o),channel:o.channel};this.applyTextureTransform(c,o),s.pbrMetallicRoughness.metallicRoughnessTexture=c}if(e.map){const o={index:this.processTexture(e.map),texCoord:e.map.channel};this.applyTextureTransform(o,e.map),s.pbrMetallicRoughness.baseColorTexture=o}if(e.emissive){const o=e.emissive;if(Math.max(o.r,o.g,o.b)>0&&(s.emissiveFactor=e.emissive.toArray()),e.emissiveMap){const l={index:this.processTexture(e.emissiveMap),texCoord:e.emissiveMap.channel};this.applyTextureTransform(l,e.emissiveMap),s.emissiveTexture=l}}if(e.normalMap){const o={index:this.processTexture(e.normalMap),texCoord:e.normalMap.channel};e.normalScale&&e.normalScale.x!==1&&(o.scale=e.normalScale.x),this.applyTextureTransform(o,e.normalMap),s.normalTexture=o}if(e.aoMap){const o={index:this.processTexture(e.aoMap),texCoord:e.aoMap.channel};e.aoMapIntensity!==1&&(o.strength=e.aoMapIntensity),this.applyTextureTransform(o,e.aoMap),s.occlusionTexture=o}e.transparent?s.alphaMode="BLEND":e.alphaTest>0&&(s.alphaMode="MASK",s.alphaCutoff=e.alphaTest),e.side===Oe&&(s.doubleSided=!0),e.name!==""&&(s.name=e.name),this.serializeUserData(e,s),this._invokeAll(function(o){o.writeMaterial&&o.writeMaterial(e,s)});const r=i.materials.push(s)-1;return t.materials.set(e,r),r}processMesh(e){const t=this.cache,i=this.json,s=[e.geometry.uuid];if(Array.isArray(e.material))for(let u=0,x=e.material.length;u<x;u++)s.push(e.material[u].uuid);else s.push(e.material.uuid);const n=s.join(":");if(t.meshes.has(n))return t.meshes.get(n);const r=e.geometry;let o;e.isLineSegments?o=M.LINES:e.isLineLoop?o=M.LINE_LOOP:e.isLine?o=M.LINE_STRIP:e.isPoints?o=M.POINTS:o=e.material.wireframe?M.LINES:M.TRIANGLES;const c={},l={},m=[],h=[],p={uv:"TEXCOORD_0",uv1:"TEXCOORD_1",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},f=r.getAttribute("normal");f!==void 0&&!this.isNormalizedNormalAttribute(f)&&(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),r.setAttribute("normal",this.createNormalizedNormalAttribute(f)));let d=null;for(let u in r.attributes){if(u.slice(0,5)==="morph")continue;const x=r.attributes[u];if(u=p[u]||u.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(u)||(u="_"+u),t.attributes.has(this.getUID(x))){l[u]=t.attributes.get(this.getUID(x));continue}d=null;const _=x.array;u==="JOINTS_0"&&!(_ instanceof Uint16Array)&&!(_ instanceof Uint8Array)&&(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),d=new j(new Uint16Array(_),x.itemSize,x.normalized));const E=this.processAccessor(d||x,r);E!==null&&(u.startsWith("_")||this.detectMeshQuantization(u,x),l[u]=E,t.attributes.set(this.getUID(x),E))}if(f!==void 0&&r.setAttribute("normal",f),Object.keys(l).length===0)return null;if(e.morphTargetInfluences!==void 0&&e.morphTargetInfluences.length>0){const u=[],x=[],y={};if(e.morphTargetDictionary!==void 0)for(const _ in e.morphTargetDictionary)y[e.morphTargetDictionary[_]]=_;for(let _=0;_<e.morphTargetInfluences.length;++_){const E={};let b=!1;for(const T in r.morphAttributes){if(T!=="position"&&T!=="normal"){b||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),b=!0);continue}const R=r.morphAttributes[T][_],w=T.toUpperCase(),v=r.attributes[T];if(t.attributes.has(this.getUID(R,!0))){E[w]=t.attributes.get(this.getUID(R,!0));continue}const G=R.clone();if(!r.morphTargetsRelative)for(let S=0,C=R.count;S<C;S++)for(let D=0;D<R.itemSize;D++)D===0&&G.setX(S,R.getX(S)-v.getX(S)),D===1&&G.setY(S,R.getY(S)-v.getY(S)),D===2&&G.setZ(S,R.getZ(S)-v.getZ(S)),D===3&&G.setW(S,R.getW(S)-v.getW(S));E[w]=this.processAccessor(G,r),t.attributes.set(this.getUID(v,!0),E[w])}h.push(E),u.push(e.morphTargetInfluences[_]),e.morphTargetDictionary!==void 0&&x.push(y[_])}c.weights=u,x.length>0&&(c.extras={},c.extras.targetNames=x)}const g=Array.isArray(e.material);if(g&&r.groups.length===0)return null;const A=g?e.material:[e.material],I=g?r.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let u=0,x=I.length;u<x;u++){const y={mode:o,attributes:l};if(this.serializeUserData(r,y),h.length>0&&(y.targets=h),r.index!==null){let E=this.getUID(r.index);(I[u].start!==void 0||I[u].count!==void 0)&&(E+=":"+I[u].start+":"+I[u].count),t.attributes.has(E)?y.indices=t.attributes.get(E):(y.indices=this.processAccessor(r.index,r,I[u].start,I[u].count),t.attributes.set(E,y.indices)),y.indices===null&&delete y.indices}const _=this.processMaterial(A[I[u].materialIndex]);_!==null&&(y.material=_),m.push(y)}c.primitives=m,i.meshes||(i.meshes=[]),this._invokeAll(function(u){u.writeMesh&&u.writeMesh(e,c)});const L=i.meshes.push(c)-1;return t.meshes.set(n,L),L}detectMeshQuantization(e,t){if(this.extensionsUsed[se])return;let i;switch(t.array.constructor){case Int8Array:i="byte";break;case Uint8Array:i="unsigned byte";break;case Int16Array:i="short";break;case Uint16Array:i="unsigned short";break;default:return}t.normalized&&(i+=" normalized");const s=e.split("_",1)[0];ge[s]&&ge[s].includes(i)&&(this.extensionsUsed[se]=!0,this.extensionsRequired[se]=!0)}processCamera(e){const t=this.json;t.cameras||(t.cameras=[]);const i=e.isOrthographicCamera,s={type:i?"orthographic":"perspective"};return i?s.orthographic={xmag:e.right*2,ymag:e.top*2,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:s.perspective={aspectRatio:e.aspect,yfov:ie.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},e.name!==""&&(s.name=e.type),t.cameras.push(s)-1}processAnimation(e,t){const i=this.json,s=this.nodeMap;i.animations||(i.animations=[]),e=ce.Utils.mergeMorphTargetTracks(e.clone(),t);const n=e.tracks,r=[],o=[];for(let c=0;c<n.length;++c){const l=n[c],m=X.parseTrackName(l.name);let h=X.findNode(t,m.nodeName);const p=me[m.propertyName];if(m.objectName==="bones"&&(h.isSkinnedMesh===!0?h=h.skeleton.getBoneByName(m.objectIndex):h=void 0),!h||!p)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',l.name),null;const f=1;let d=l.values.length/l.times.length;p===me.morphTargetInfluences&&(d/=h.morphTargetInfluences.length);let g;l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline===!0?(g="CUBICSPLINE",d/=3):l.getInterpolation()===ze?g="STEP":g="LINEAR",o.push({input:this.processAccessor(new j(l.times,f)),output:this.processAccessor(new j(l.values,d)),interpolation:g}),r.push({sampler:o.length-1,target:{node:s.get(h),path:p}})}return i.animations.push({name:e.name||"clip_"+i.animations.length,samplers:o,channels:r}),i.animations.length-1}processSkin(e){const t=this.json,i=this.nodeMap,s=t.nodes[i.get(e)],n=e.skeleton;if(n===void 0)return null;const r=e.skeleton.bones[0];if(r===void 0)return null;const o=[],c=new Float32Array(n.bones.length*16),l=new Pe;for(let h=0;h<n.bones.length;++h)o.push(i.get(n.bones[h])),l.copy(n.boneInverses[h]),l.multiply(e.bindMatrix).toArray(c,h*16);return t.skins===void 0&&(t.skins=[]),t.skins.push({inverseBindMatrices:this.processAccessor(new j(c,16)),joints:o,skeleton:i.get(r)}),s.skin=t.skins.length-1}processNode(e){const t=this.json,i=this.options,s=this.nodeMap;t.nodes||(t.nodes=[]);const n={};if(i.trs){const o=e.quaternion.toArray(),c=e.position.toArray(),l=e.scale.toArray();V(o,[0,0,0,1])||(n.rotation=o),V(c,[0,0,0])||(n.translation=c),V(l,[1,1,1])||(n.scale=l)}else e.matrixAutoUpdate&&e.updateMatrix(),It(e.matrix)===!1&&(n.matrix=e.matrix.elements);if(e.name!==""&&(n.name=String(e.name)),this.serializeUserData(e,n),e.isMesh||e.isLine||e.isPoints){const o=this.processMesh(e);o!==null&&(n.mesh=o)}else e.isCamera&&(n.camera=this.processCamera(e));if(e.isSkinnedMesh&&this.skins.push(e),e.children.length>0){const o=[];for(let c=0,l=e.children.length;c<l;c++){const m=e.children[c];if(m.visible||i.onlyVisible===!1){const h=this.processNode(m);h!==null&&o.push(h)}}o.length>0&&(n.children=o)}this._invokeAll(function(o){o.writeNode&&o.writeNode(e,n)});const r=t.nodes.push(n)-1;return s.set(e,r),r}processScene(e){const t=this.json,i=this.options;t.scenes||(t.scenes=[],t.scene=0);const s={};e.name!==""&&(s.name=e.name),t.scenes.push(s);const n=[];for(let r=0,o=e.children.length;r<o;r++){const c=e.children[r];if(c.visible||i.onlyVisible===!1){const l=this.processNode(c);l!==null&&n.push(l)}}n.length>0&&(s.nodes=n),this.serializeUserData(e,s)}processObjects(e){const t=new Y;t.name="AuxScene";for(let i=0;i<e.length;i++)t.children.push(e[i]);this.processScene(t)}processInput(e){const t=this.options;e=e instanceof Array?e:[e],this._invokeAll(function(s){s.beforeParse&&s.beforeParse(e)});const i=[];for(let s=0;s<e.length;s++)e[s]instanceof Y?this.processScene(e[s]):i.push(e[s]);i.length>0&&this.processObjects(i);for(let s=0;s<this.skins.length;++s)this.processSkin(this.skins[s]);for(let s=0;s<t.animations.length;++s)this.processAnimation(t.animations[s],e[0]);this._invokeAll(function(s){s.afterParse&&s.afterParse(e)})}_invokeAll(e){for(let t=0,i=this.plugins.length;t<i;t++)e(this.plugins[t])}}class St{constructor(e){this.writer=e,this.name="KHR_lights_punctual"}writeNode(e,t){if(!e.isLight)return;if(!e.isDirectionalLight&&!e.isPointLight&&!e.isSpotLight){console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e);return}const i=this.writer,s=i.json,n=i.extensionsUsed,r={};e.name&&(r.name=e.name),r.color=e.color.toArray(),r.intensity=e.intensity,e.isDirectionalLight?r.type="directional":e.isPointLight?(r.type="point",e.distance>0&&(r.range=e.distance)):e.isSpotLight&&(r.type="spot",e.distance>0&&(r.range=e.distance),r.spot={},r.spot.innerConeAngle=(e.penumbra-1)*e.angle*-1,r.spot.outerConeAngle=e.angle),e.decay!==void 0&&e.decay!==2&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),e.target&&(e.target.parent!==e||e.target.position.x!==0||e.target.position.y!==0||e.target.position.z!==-1)&&console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),n[this.name]||(s.extensions=s.extensions||{},s.extensions[this.name]={lights:[]},n[this.name]=!0);const o=s.extensions[this.name].lights;o.push(r),t.extensions=t.extensions||{},t.extensions[this.name]={light:o.length-1}}}class Lt{constructor(e){this.writer=e,this.name="KHR_materials_unlit"}writeMaterial(e,t){if(!e.isMeshBasicMaterial)return;const s=this.writer.extensionsUsed;t.extensions=t.extensions||{},t.extensions[this.name]={},s[this.name]=!0,t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9}}class Nt{constructor(e){this.writer=e,this.name="KHR_materials_clearcoat"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||e.clearcoat===0)return;const i=this.writer,s=i.extensionsUsed,n={};if(n.clearcoatFactor=e.clearcoat,e.clearcoatMap){const r={index:i.processTexture(e.clearcoatMap),texCoord:e.clearcoatMap.channel};i.applyTextureTransform(r,e.clearcoatMap),n.clearcoatTexture=r}if(n.clearcoatRoughnessFactor=e.clearcoatRoughness,e.clearcoatRoughnessMap){const r={index:i.processTexture(e.clearcoatRoughnessMap),texCoord:e.clearcoatRoughnessMap.channel};i.applyTextureTransform(r,e.clearcoatRoughnessMap),n.clearcoatRoughnessTexture=r}if(e.clearcoatNormalMap){const r={index:i.processTexture(e.clearcoatNormalMap),texCoord:e.clearcoatNormalMap.channel};i.applyTextureTransform(r,e.clearcoatNormalMap),n.clearcoatNormalTexture=r}t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}}class vt{constructor(e){this.writer=e,this.name="KHR_materials_iridescence"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||e.iridescence===0)return;const i=this.writer,s=i.extensionsUsed,n={};if(n.iridescenceFactor=e.iridescence,e.iridescenceMap){const r={index:i.processTexture(e.iridescenceMap),texCoord:e.iridescenceMap.channel};i.applyTextureTransform(r,e.iridescenceMap),n.iridescenceTexture=r}if(n.iridescenceIor=e.iridescenceIOR,n.iridescenceThicknessMinimum=e.iridescenceThicknessRange[0],n.iridescenceThicknessMaximum=e.iridescenceThicknessRange[1],e.iridescenceThicknessMap){const r={index:i.processTexture(e.iridescenceThicknessMap),texCoord:e.iridescenceThicknessMap.channel};i.applyTextureTransform(r,e.iridescenceThicknessMap),n.iridescenceThicknessTexture=r}t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}}class Ut{constructor(e){this.writer=e,this.name="KHR_materials_transmission"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||e.transmission===0)return;const i=this.writer,s=i.extensionsUsed,n={};if(n.transmissionFactor=e.transmission,e.transmissionMap){const r={index:i.processTexture(e.transmissionMap),texCoord:e.transmissionMap.channel};i.applyTextureTransform(r,e.transmissionMap),n.transmissionTexture=r}t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}}class Ct{constructor(e){this.writer=e,this.name="KHR_materials_volume"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||e.transmission===0)return;const i=this.writer,s=i.extensionsUsed,n={};if(n.thicknessFactor=e.thickness,e.thicknessMap){const r={index:i.processTexture(e.thicknessMap),texCoord:e.thicknessMap.channel};i.applyTextureTransform(r,e.thicknessMap),n.thicknessTexture=r}n.attenuationDistance=e.attenuationDistance,n.attenuationColor=e.attenuationColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}}class Ft{constructor(e){this.writer=e,this.name="KHR_materials_ior"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||e.ior===1.5)return;const s=this.writer.extensionsUsed,n={};n.ior=e.ior,t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}}class Bt{constructor(e){this.writer=e,this.name="KHR_materials_specular"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||e.specularIntensity===1&&e.specularColor.equals(_t)&&!e.specularIntensityMap&&!e.specularColorTexture)return;const i=this.writer,s=i.extensionsUsed,n={};if(e.specularIntensityMap){const r={index:i.processTexture(e.specularIntensityMap),texCoord:e.specularIntensityMap.channel};i.applyTextureTransform(r,e.specularIntensityMap),n.specularTexture=r}if(e.specularColorMap){const r={index:i.processTexture(e.specularColorMap),texCoord:e.specularColorMap.channel};i.applyTextureTransform(r,e.specularColorMap),n.specularColorTexture=r}n.specularFactor=e.specularIntensity,n.specularColorFactor=e.specularColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}}class Gt{constructor(e){this.writer=e,this.name="KHR_materials_sheen"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||e.sheen==0)return;const i=this.writer,s=i.extensionsUsed,n={};if(e.sheenRoughnessMap){const r={index:i.processTexture(e.sheenRoughnessMap),texCoord:e.sheenRoughnessMap.channel};i.applyTextureTransform(r,e.sheenRoughnessMap),n.sheenRoughnessTexture=r}if(e.sheenColorMap){const r={index:i.processTexture(e.sheenColorMap),texCoord:e.sheenColorMap.channel};i.applyTextureTransform(r,e.sheenColorMap),n.sheenColorTexture=r}n.sheenRoughnessFactor=e.sheenRoughness,n.sheenColorFactor=e.sheenColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}}class Dt{constructor(e){this.writer=e,this.name="KHR_materials_anisotropy"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||e.anisotropy==0)return;const i=this.writer,s=i.extensionsUsed,n={};if(e.anisotropyMap){const r={index:i.processTexture(e.anisotropyMap)};i.applyTextureTransform(r,e.anisotropyMap),n.anisotropyTexture=r}n.anisotropyStrength=e.anisotropy,n.anisotropyRotation=e.anisotropyRotation,t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}}class kt{constructor(e){this.writer=e,this.name="KHR_materials_emissive_strength"}writeMaterial(e,t){if(!e.isMeshStandardMaterial||e.emissiveIntensity===1)return;const s=this.writer.extensionsUsed,n={};n.emissiveStrength=e.emissiveIntensity,t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}}ce.Utils={insertKeyframe:function(a,e){const i=a.getValueSize(),s=new a.TimeBufferType(a.times.length+1),n=new a.ValueBufferType(a.values.length+i),r=a.createInterpolant(new a.ValueBufferType(i));let o;if(a.times.length===0){s[0]=e;for(let c=0;c<i;c++)n[c]=0;o=0}else if(e<a.times[0]){if(Math.abs(a.times[0]-e)<.001)return 0;s[0]=e,s.set(a.times,1),n.set(r.evaluate(e),0),n.set(a.values,i),o=0}else if(e>a.times[a.times.length-1]){if(Math.abs(a.times[a.times.length-1]-e)<.001)return a.times.length-1;s[s.length-1]=e,s.set(a.times,0),n.set(a.values,0),n.set(r.evaluate(e),a.values.length),o=s.length-1}else for(let c=0;c<a.times.length;c++){if(Math.abs(a.times[c]-e)<.001)return c;if(a.times[c]<e&&a.times[c+1]>e){s.set(a.times.slice(0,c+1),0),s[c+1]=e,s.set(a.times.slice(c+1),c+2),n.set(a.values.slice(0,(c+1)*i),0),n.set(r.evaluate(e),(c+1)*i),n.set(a.values.slice((c+1)*i),(c+2)*i),o=c+1;break}}return a.times=s,a.values=n,o},mergeMorphTargetTracks:function(a,e){const t=[],i={},s=a.tracks;for(let n=0;n<s.length;++n){let r=s[n];const o=X.parseTrackName(r.name),c=X.findNode(e,o.nodeName);if(o.propertyName!=="morphTargetInfluences"||o.propertyIndex===void 0){t.push(r);continue}if(r.createInterpolant!==r.InterpolantFactoryMethodDiscrete&&r.createInterpolant!==r.InterpolantFactoryMethodLinear){if(r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),r=r.clone(),r.setInterpolation(He)}const l=c.morphTargetInfluences.length,m=c.morphTargetDictionary[o.propertyIndex];if(m===void 0)throw new Error("THREE.GLTFExporter: Morph target name not found: "+o.propertyIndex);let h;if(i[c.uuid]===void 0){h=r.clone();const f=new h.ValueBufferType(l*h.times.length);for(let d=0;d<h.times.length;d++)f[d*l+m]=h.values[d];h.name=(o.nodeName||"")+".morphTargetInfluences",h.values=f,i[c.uuid]=h,t.push(h);continue}const p=r.createInterpolant(new r.ValueBufferType(1));h=i[c.uuid];for(let f=0;f<h.times.length;f++)h.values[f*l+m]=p.evaluate(h.times[f]);for(let f=0;f<r.times.length;f++){const d=this.insertKeyframe(h,r.times[f]);h.values[d*l+m]=r.values[f]}}return a.tracks=t,a}};const Ot=""+new URL("download.26a805ce.svg",import.meta.url).href,zt={class:"sidebar"},Pt={class:"mesh-list scroll-x"},Ht={class:"scroll-y"},Vt=["id","onClick"],Yt=J({__name:"mesh-list",emits:["update:modelValue"],setup(a,{emit:e}){const{loadMesh:t,selectedMeshAsset:i,meshes:s,meshName:n}=ae(),r=Ee(!0),o=re(()=>r.value?"Hide list":"Show list");function c(){r.value=!r.value}pe("ArrowDown",h=>{var f;if(h.preventDefault(),!l.value)return;const p=l.value.findIndex(d=>d===n.value);p<0||p>=l.value.length-1||(n.value=l.value[p+1],(f=document.getElementById(`mesh-${p}`))==null||f.scrollIntoView({block:"center"}))}),pe("ArrowUp",h=>{var f;if(h.preventDefault(),!l.value)return;const p=l.value.findIndex(d=>d===n.value);p<1||p>=l.value.length||(n.value=l.value[p-1],(f=document.getElementById(`mesh-${p}`))==null||f.scrollIntoView({block:"center"}))});const l=re(()=>s.value.map(h=>h.name));async function m(){console.log("download",i.value);const h=i.value;if(!h)return;const p=await t(h.entry),f=new Y;f.add(p);const d=new ce,g={binary:!0};d.parse(f,A=>{console.log("download GLTF:",A);const I=document.createElement("a"),L=new Blob([A],{type:"model/gltf-binary"});I.href=URL.createObjectURL(L),I.download=`${h.name}.gltf`,I.click()},console.error,g)}return(h,p)=>{const f=Tt;return O(),P("div",zt,[k("div",null,[k("div",{to:"/",onClick:p[0]||(p[0]=d=>h.$router.push("/")),class:"btn btn-round"}," < "),k("div",{onClick:c,class:"btn"},he(U(o)),1),k("div",{onClick:m,class:"btn btn-icon"},[q(f,{icon:U(Ot),size:24},null,8,["icon"])])]),k("div",Pt,[k("div",Ht,[(O(!0),P(Me,null,Je(U(l),(d,g)=>Ze((O(),P("div",{id:`mesh-${g}`,onClick:A=>n.value=d,class:et({active:d===U(n)})},he(d),11,Vt)),[[Qe,U(r)]])),256))])])])}}});const jt=Re(Yt,[["__scopeId","data-v-efac70f9"]]);function Kt(){const a=new Y,e=new fe("white",1);e.position.set(-2,20,-5),a.add(e);const t=new fe("#FDA",.1);t.position.set(2,-20,5),a.add(t);const i=new tt(256);i.texture.type=H;const s=new st(1,1e3,i);return{scene:a,cubeCamera:s,cubeRenderTarget:i}}class $t extends nt{constructor(e){super(e),this.type=H}parse(e){const o=function(u,x){switch(u){case 1:console.error("THREE.RGBELoader Read Error: "+(x||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(x||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(x||""));break;default:case 4:console.error("THREE.RGBELoader: Error: "+(x||""))}return-1},h=`
`,p=function(u,x,y){x=x||1024;let E=u.pos,b=-1,T=0,R="",w=String.fromCharCode.apply(null,new Uint16Array(u.subarray(E,E+128)));for(;0>(b=w.indexOf(h))&&T<x&&E<u.byteLength;)R+=w,T+=w.length,E+=128,w+=String.fromCharCode.apply(null,new Uint16Array(u.subarray(E,E+128)));return-1<b?(y!==!1&&(u.pos+=T+b+1),R+w.slice(0,b)):!1},f=function(u){const x=/^#\?(\S+)/,y=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,_=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,E=/^\s*FORMAT=(\S+)\s*$/,b=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,T={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let R,w;if(u.pos>=u.byteLength||!(R=p(u)))return o(1,"no header found");if(!(w=R.match(x)))return o(3,"bad initial token");for(T.valid|=1,T.programtype=w[1],T.string+=R+`
`;R=p(u),R!==!1;){if(T.string+=R+`
`,R.charAt(0)==="#"){T.comments+=R+`
`;continue}if((w=R.match(y))&&(T.gamma=parseFloat(w[1])),(w=R.match(_))&&(T.exposure=parseFloat(w[1])),(w=R.match(E))&&(T.valid|=2,T.format=w[1]),(w=R.match(b))&&(T.valid|=4,T.height=parseInt(w[1],10),T.width=parseInt(w[2],10)),T.valid&2&&T.valid&4)break}return T.valid&2?T.valid&4?T:o(3,"missing image size specifier"):o(3,"missing format specifier")},d=function(u,x,y){const _=x;if(_<8||_>32767||u[0]!==2||u[1]!==2||u[2]&128)return new Uint8Array(u);if(_!==(u[2]<<8|u[3]))return o(3,"wrong scanline width");const E=new Uint8Array(4*x*y);if(!E.length)return o(4,"unable to allocate buffer space");let b=0,T=0;const R=4*_,w=new Uint8Array(4),v=new Uint8Array(R);let G=y;for(;G>0&&T<u.byteLength;){if(T+4>u.byteLength)return o(1);if(w[0]=u[T++],w[1]=u[T++],w[2]=u[T++],w[3]=u[T++],w[0]!=2||w[1]!=2||(w[2]<<8|w[3])!=_)return o(3,"bad rgbe scanline format");let S=0,C;for(;S<R&&T<u.byteLength;){C=u[T++];const F=C>128;if(F&&(C-=128),C===0||S+C>R)return o(3,"bad scanline data");if(F){const B=u[T++];for(let le=0;le<C;le++)v[S++]=B}else v.set(u.subarray(T,T+C),S),S+=C,T+=C}const D=_;for(let F=0;F<D;F++){let B=0;E[b]=v[F+B],B+=_,E[b+1]=v[F+B],B+=_,E[b+2]=v[F+B],B+=_,E[b+3]=v[F+B],b+=4}G--}return E},g=function(u,x,y,_){const E=u[x+3],b=Math.pow(2,E-128)/255;y[_+0]=u[x+0]*b,y[_+1]=u[x+1]*b,y[_+2]=u[x+2]*b,y[_+3]=1},A=function(u,x,y,_){const E=u[x+3],b=Math.pow(2,E-128)/255;y[_+0]=K.toHalfFloat(Math.min(u[x+0]*b,65504)),y[_+1]=K.toHalfFloat(Math.min(u[x+1]*b,65504)),y[_+2]=K.toHalfFloat(Math.min(u[x+2]*b,65504)),y[_+3]=K.toHalfFloat(1)},I=new Uint8Array(e);I.pos=0;const L=f(I);if(L!==-1){const u=L.width,x=L.height,y=d(I.subarray(I.pos),u,x);if(y!==-1){let _,E,b;switch(this.type){case Q:b=y.length/4;const T=new Float32Array(b*4);for(let w=0;w<b;w++)g(y,w*4,T,w*4);_=T,E=Q;break;case H:b=y.length/4;const R=new Uint16Array(b*4);for(let w=0;w<b;w++)A(y,w*4,R,w*4);_=R,E=H;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type);break}return{width:u,height:x,data:_,header:L.string,gamma:L.gamma,exposure:L.exposure,type:E}}}return null}setDataType(e){return this.type=e,this}load(e,t,i,s){function n(r,o){switch(r.type){case Q:case H:r.colorSpace=rt,r.minFilter=oe,r.magFilter=oe,r.generateMipmaps=!1,r.flipY=!0;break}t&&t(r,o)}return super.load(e,n,i,s)}}const Wt=J({__name:"mesh-viewer",setup(a){const e=ht(),t=Ee(),{loadMesh:i,selectedMeshAsset:s,meshes:n,meshName:r}=ae(),{scene:o,cubeCamera:c,cubeRenderTarget:l}=Kt(),m=new it;return o.add(m),ot([n,r],async()=>{const h=ft(s.value);if(!h)return;console.log("Loading asset from APK:",h);const p=await i(h.entry,l);p.geometry.computeBoundingSphere();const{center:f,radius:d}=p.geometry.boundingSphere;p.geometry.translate(-f.x,-f.y,-f.z),p.scale.divideScalar(d/5),console.log("loaded mesh:",h.name,{center:f,radius:d,mesh:p}),m.clear(),m.add(p);const{renderer:g,render:A}=t.value??{};!g||!A||(c.update(g,o),A())},{immediate:!0}),at(()=>{const{orbit:h,render:p,renderer:f}=t.value;h.object.position.set(-6,10,-10),h.target.set(0,0,0),h.update(),p(),f.toneMapping=ct,new $t().setPath(e.baseURL).load("kloofendal_48d_partly_cloudy_puresky_1k.hdr",function(d){d.mapping=lt,o.background=d,o.environment=d,p()})}),(h,p)=>(O(),Ie(U(ut),{ref_key:"perspective",ref:t,scene:U(o)},null,8,["scene"]))}}),qt={class:"app"},Xt={key:0,class:"overlay"},Jt={class:"inlay"},Zt=J({__name:"mesh",setup(a){const{meshes:e,meshName:t}=ae();return(i,s)=>{const n=jt,r=Wt,o=gt,c=mt;return O(),P(Me,null,[k("div",qt,[U(e).length?(O(),Ie(n,{key:0,modelValue:U(t),"onUpdate:modelValue":s[0]||(s[0]=l=>dt(t)?t.value=l:null)},null,8,["modelValue"])):de("",!0),q(o,null,{default:pt(()=>[q(r,{mesh:U(t)},null,8,["mesh"])]),_:1})]),U(e).length===0?(O(),P("div",Xt,[k("div",Jt,[q(c)])])):de("",!0)],64)}}});const ts=Re(Zt,[["__scopeId","data-v-fd077d37"]]);export{ts as default};
